typedef struct p{int h,d;}p;int c(const void* a,const void* b){return (*(p*)a).h-(*(p*)b).h;}p t[50001];N,Q,s[50001],i,j,k,a,b,x,y;main(){scanf("%d%d",&N,&Q);for(i=0;i<N;i++)scanf("%d",s+i),t[i].d=i,t[i].h=s[i];qsort(t,N,sizeof(p),c);for(i=0;i<Q;printf("%d\n",x-y),i++){scanf("%d%d",&a,&b);if(b-a<99){for(y=1000001,x=0,j=a-1;j<b;y=y>s[j]?s[j]:y,j++)x=x<s[j]?s[j]:x;}else{for(j=0;j<N&&!(t[j].d>a-2&&t[j].d<b);j++);for(k=N-1;k>=0&&!(t[k].d>a-2&&t[k].d<b);k--);x=t[k].h;y=t[j].h;}}}